")
print(f"
print(file_content.strip())

# Folder: backend/user_account_management/services/
# File: password_reset_service.py
file_content = 
# Epic Title: User Account Management

import secrets
from backend.user_account_management.repositories.user_repository import UserRepository
from backend.user_account_management.repositories.password_reset_token_repository import PasswordResetTokenRepository
from backend.user_account_management.models.password_reset_token import PasswordResetToken

class PasswordResetService:
    def __init__(
        self, 
        user_repo: UserRepository = UserRepository(), 
        token_repo: PasswordResetTokenRepository = PasswordResetTokenRepository()
    ):
        self.user_repo = user_repo
        self.token_repo = token_repo

    def initiate_reset(self, email: str):
        user = self.user_repo.get_user_by_email(email)
        if not user:
            raise ValueError("User not found")

        token = secrets.token_urlsafe()
        reset_token = PasswordResetToken(user_id=user.id, token=token)
        self.token_repo.create_token(reset_token)
        self.send_email(user.email, token)

    def send_email(self, email: str, token: str):
        # Placeholder for sending email logic
        print(f"Sending email to {email} with token {token}")

    def validate_token(self, token: str):
        reset_token = self.token_repo.get_token(token)
        if not reset_token or reset_token.is_expired():
            raise ValueError("Invalid or expired token")
        return reset_token.user


memory_ledger["emitted_file_paths"].append(f"{base_folder}/services/password_reset_service.py")
memory_ledger["folder_file_mapping"][f"{base_folder}/services/"].append("password_reset_service.py")

print("