")
print(f"
print(file_content.strip())

# Folder: backend/product_catalog_management/repositories/
# File: product_repository.py
file_content = 
# Epic Title: Product Catalog Management

from sqlalchemy.orm import Session
from backend.product_catalog_management.models.product import Product, Session as db_session

class ProductRepository:
    def __init__(self, session: Session = db_session()):
        self.session = session

    def add_product(self, product: Product):
        self.session.add(product)
        self.session.commit()

    def get_product_by_name(self, name: str) -> Product:
        return self.session.query(Product).filter(Product.name==name, Product.is_deleted==0).first()

    def get_product_by_id(self, product_id: int) -> Product:
        return self.session.query(Product).filter(Product.id==product_id, Product.is_deleted==0).first()

    def get_all_products(self):
        return self.session.query(Product).filter(Product.is_deleted==0).all()

    def search_products(self, query: str, page: int, limit: int):
        return self.session.query(Product).filter(
            Product.is_deleted==0,
            (Product.name.like(f'%{query}%') | 
            Product.description.like(f'%{query}%'))
        ).offset((page - 1) * limit).limit(limit).all()
        
    def update_product(self, product: Product):
        existing_product = self.get_product_by_id(product.id)
        if not existing_product:
            return False
        existing_product.name = product.name
        existing_product.price = product.price
        existing_product.description = product.description
        existing_product.category_id = product.category_id
        self.session.commit()
        return True

    def delete_product(self, product_id: int):
        product = self.get_product_by_id(product_id)
        if not product:
            return False
        product.is_deleted = 1  # Soft delete
        self.session.commit()
        return True


memory_ledger["emitted_file_paths"].append(f"{base_folder}/repositories/product_repository.py")
memory_ledger["folder_file_mapping"][f"{base_folder}/repositories/"].append("product_repository.py")

print("