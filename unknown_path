# Epic Title: User Account Management

# In-memory ledger initialization
memory_ledger = {
    "emitted_file_paths": [],
    "declared_entities": [],
    "public_interfaces": [],
    "imports": [],
    "folder_file_mapping": {},
    "persistent_fields": {},
    "folder_responsibilities": {
        "backend/user_account_management/controllers": "Endpoints related to user account management",
        "backend/user_account_management/models": "Database models for user account management",
        "backend/user_account_management/repositories": "Database interaction for user account management",
        "backend/user_account_management/services": "Business logic for user account management"
    }
}

# Declaring new entities and interfaces
memory_ledger["declared_entities"].extend(["User"])
memory_ledger["public_interfaces"].extend(["UserRepository", "UserService", "user_blueprint"])
memory_ledger["imports"].extend([
    "backend.user_account_management.models.user:User",
    "backend.user_account_management.repositories.user_repository:UserRepository",
    "backend.user_account_management.services.user_service:UserService"
])

# Folder file mapping
base_folder = "backend/user_account_management"
memory_ledger["folder_file_mapping"] = {
    f"{base_folder}/controllers/": ["user_controller.py"],
    f"{base_folder}/models/": ["user.py"],
    f"{base_folder}/repositories/": ["user_repository.py"],
    f"{base_folder}/services/": ["user_service.py"]
}

# Folder: backend/user_account_management/controllers/
# File: user_controller.py
file_content = 
# Epic Title: User Account Management

from flask import Blueprint, request, jsonify
from flask_login import login_user, logout_user, login_required
from backend.user_account_management.services.user_service import UserService

user_blueprint = Blueprint('user', __name__)
user_service = UserService()

@user_blueprint.route('/register', methods=['POST'])
def register_user():
    data = request.json
    email = data.get('email')
    password = data.get('password')
    try:
        user_service.register_user(email, password)
        return jsonify({'message': 'User registered successfully'}), 201
    except ValueError as e:
        return jsonify({'error': str(e)}), 400

@user_blueprint.route('/login', methods=['POST'])
def login_user():
    data = request.json
    email = data.get('email')
    password = data.get('password')
    try:
        user = user_service.authenticate_user(email, password)
        login_user(user, remember=True)
        return jsonify({'message': 'User logged in successfully'}), 200
    except ValueError as e:
        return jsonify({'error': str(e)}), 400

@user_blueprint.route('/logout', methods=['POST'])
@login_required
def logout():
    logout_user()
    return jsonify({'message': 'User logged out successfully'}), 200


memory_ledger["emitted_file_paths"].append(f"{base_folder}/controllers/user_controller.py")
memory_ledger["folder_file_mapping"][f"{base_folder}/controllers/"].append("user_controller.py")

print("