")
print("
print(file_content.strip())

# Folder: backend/shopping_cart_functionality/services/
# File: cart_service.py
file_content = 
# Epic Title: Shopping Cart Functionality

from backend.product_catalog_management.models.product import Product
from backend.shopping_cart_functionality.repositories.cart_repository import CartRepository
from backend.shopping_cart_functionality.repositories.cart_item_repository import CartItemRepository
from backend.shopping_cart_functionality.models.cart_item import CartItem
from backend.shopping_cart_functionality.models.cart import Cart

class CartService:
    def __init__(self, cart_repository: CartRepository = CartRepository(), cart_item_repository: CartItemRepository = CartItemRepository()):
        self.cart_repository = cart_repository
        self.cart_item_repository = cart_item_repository

    def add_to_cart(self, user_id: int, product: Product, quantity: int = 1):
        cart = self.cart_repository.get_cart_by_user_id(user_id)
        
        if not cart:
            cart = Cart(user_id=user_id)
            self.cart_repository.create_cart(cart)
        
        cart_item = self.cart_item_repository.get_cart_item(cart.id, product.id)
        if cart_item:
            cart_item.quantity += quantity
            self.cart_item_repository.update_cart_item(cart_item)
        else:
            new_cart_item = CartItem(cart_id=cart.id, product_id=product.id, quantity=quantity)
            self.cart_item_repository.add_cart_item(new_cart_item)
        
        return cart


memory_ledger["emitted_file_paths"].append("backend/shopping_cart_functionality/services/cart_service.py")
memory_ledger["folder_file_mapping"]["backend/shopping_cart_functionality/services/"].append("cart_service.py")

print("